---
output: github_document
---


<!-- 
README.md is generated from README.Rmd. 
Please edit that file 
-->

```{r include=FALSE}
# Create .nojekyll file in the /docs folder
file.create('docs/.nojekyll')
# Avoid problems with "Onedrive - Universidade da Coruña" 
# devtools::check(getwd()) 
# pkgdown::build_site()
library(esios2fd)
```


# esios2fd: Download and Convert ESIOS Indicators to Functional Data


### `r paste("Version", packageVersion("esios2fd"))`

This package provides tools for fetching time-series data from Spain’s ESIOS API and transforming them into functional data objects (`fdata`) and combined daily matrices (`ldata`). This vignette walks through the typical workflow.


```{r echo=FALSE, results='asis'}
if ('github_document' == rmarkdown::all_output_formats(knitr::current_input()) && !knitr:::is_html_output()) 
   cat('For more information visit the [web page](https://moviedo5.github.io/esios2fd) of the package.')
```


## Main Functions

* `esios2indicators(api_key, output_dir, verbose = FALSE)` – Retrieve and save catalog of ESIOS indicators (IDs, short names, units) as CSV and RDA.
* `esios2csv(var_names, years, api_key, resolution = c("hour", "min"), output_dir, verbose = FALSE)` – Download raw time-series CSVs with standardized timestamps.
* `esios2fdata(var_names, years, resolution = c("hour", "min"), input_dir, output_dir, verbose = TRUE)` – Convert CSVs into functional data (`fdata`) objects, handle DST shifts, save `.rda` files.
* `esios2ldata(years, var_names, resolution = c("hour", "min"), input_dir, mode = c("csv","rda"), verbose = FALSE)` – Combine variables and years into unified `ldata` list with daily flags and stacked `fdata` objects.

See the [Reference](/reference/index.html) for full documentation.

## Installation

```r
# install.packages("remotes")
remotes::install_github("moviedo5/esios2fd")
```
# Usage Example I (by year)

```r
library(esios2fd)

# 1. Fetch indicator catalog
api_key <- "YOUR_API_KEY"
esios2indicator(api_key, output_dir = "./data_indicators")

# 2. Download hourly data for wind and solar PV
vars <- c("Wind_551", "Solar_PV_119")
years <- 2023:2024
esios2csv(vars, years, api_key,
          resolution = "hour",
          output_dir  = "./data_csv",
          verbose     = TRUE)

# 3. Create functional data objects (.rda)
esios2fdata(vars, years,
            resolution = "hour",
            input_dir  = "./data_csv",
            output_dir = "./data_rda",
            verbose    = TRUE)

# 4. Combine into unified ldata object
ldata <- esios2ldata(years, vars,
                     resolution = "hour",
                     input_dir  = "./data_rda",
                     mode       = "rda",
                     verbose    = TRUE)

# Plot example
plot(ldata$Wind_551)
```


# Usage Example II (by date)

```r
library(esios2fd)

# 1. Fetch indicator catalog
# api_key <- "YOUR_API_KEY"
# esios2indicator(api_key, output_dir = "./data_indicators")

vars <- c("Wind_551", "Solar_PV_119")
years <- 2023:2024

# 2.a Create data frame with hourly data
dfh <- esios2df(vars, "2020-01-01", "2020-01-15",
         api_key, resolution = "hour", TRUE)
plot(dfh[,c(2,4)])         
# 2.b Create data frame with 10-minute resolution data
dfm <- esios2df(vars, "2020-01-01", "2020-01-15",
               api_key, resolution = "min", TRUE)
plot(dfh[,c(2,4)])         

ldath <- esios2lfdata(vars, "2020-01-01", "2020-01-15",
                     api_key, "hour", F)
plot(ldath)
                     
ldatm <- esios2lfdata(vars, "2020-01-01", "2020-01-15",
                     api_key, "hour", F)
                     
plot(ldatm)
```

<!-- 
# install.packages("roxygen2")
# install.packages("devtools")
# install.packages("pkgdown")

library(roxygen2)
library(devtools)
# setwd("D:/Users/moviedo/github/fda.usc/")

pkgbuild::compile_dll()
#roxygenize()
devtools::document()
1

tools::checkRd("man/esios2df.Rd")
tools::checkRd("man/esios2ldata.Rd")
tools::checkRd("man/esios2indicators.Rd")
tools::checkRd("man/esios2lfdata.Rd")
tools::checkRd("man/esios2csv.Rd")
tools::checkRd("man/esios2fdata.Rd")


library(devtools)
devtools::build()


library(pkgdown)
# pkgdown::clean_site(force = TRUE)
pkgdown::build_site()

devtools::check()
devtools::install()
# devtools::build_win()

# devtools::install_github("moviedo5/fda.usc",auth_user="moviedo5")
R CMD check --as-cran and R-wind-builder 
 
R CMD build fda.usc
R CMD check fda.usc_2.2.0.tar.gz --as-cran  R-wind-builder 
R CMD INSTALL fda.usc_2.2.0.tar.gz --build





-->

# License

MIT + file LICENSE

# Information download from API

The new esios public website makes available of everybody an API for data download, which is detailed at https://api.esios.ree.es.

Calls displayed in this documentation are only examples.

To use API you must request a personal token by mailing to consultasios@@ree.es, due to public current token changes often.

# API para descarga de información
Este paquete cconsulta la API de esios (https://api.esios.ree.es), pra poder utilizar esta API el usuario debe solicitar su token personal enviando un correo indicando su nombre y apellidos a consultasios@ree.es.

Todas las peticiones se realizan a la API de ESIOS. **Debe seguirse** estrictamente
*las indicaciones oficiales de la API de REE*:
- El token se emite para uso personal del solicitante.
- En aplicaciones públicas, los datos deben almacenarse en un servidor propio
  y no hacerse peticiones directas a los sistemas de REE.
- Evitar peticiones masivas, redundantes o innecesarias (por ejemplo, datos
  ya descargados o indicadores inexistentes).
  

## Authors

* **Manuel Oviedo de la Fuente** [manuel.oviedo@udc.es](mailto:manuel.oviedo@udc.es)

# Citation

If you use **esios2fd** in published research, please cite:

> Oviedo de la Fuente, M. (2025). *esios2fd: Download and Convert ESIOS Indicators
to Functional Data*. R package version 0.1.0.

## Acknowledgments

This work was supported by grants from MICINN and the Xunta de Galicia (ED431C-2020-14, ED431G-2019/01), co-financed by the ERDF.


## References

* Febrero-Bande, M. and Oviedo de la Fuente, M. (2012). Statistical Computing in Functional Data Analysis: The R Package fda.usc. *Journal of Statistical Software*, 51(4):1–28. [https://doi.org/10.18637/jss.v051.i04](https://doi.org/10.18637/jss.v051.i04)
